<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="theme-color" content="#6c2bd9" />
    <title>Purple TV</title>

    <!-- ✅ الخط -->
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />

    <!-- ✅ Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ✅ PWA manifest من Vite -->
    <link rel="manifest" href="/manifest.webmanifest" />

    <style>
      html {
        scroll-behavior: smooth;
      }
      body {
        font-family: "Inter", sans-serif;
        background-color: #0D0D12;
        color: #FFFFFF;
        margin: 0;
        padding: 0;
      }
      #root {
        min-height: 100vh;
      }
    </style>

    <!-- ✅ تعطيل الكاش القديم -->
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.getRegistrations().then((regs) =>
          regs.forEach((r) => r.unregister())
        );
      }
    </script>
    <!-- تحسين اللغة/الاتجاه مبكرًا وتضمين النمط العام -->
    <script>
      (function() {
        try {
          var saved = localStorage.getItem('lang');
          var lang = saved || (navigator.language || 'ar').slice(0,2);
          if (lang !== 'ar' && lang !== 'en') lang = 'en';
          document.documentElement.lang = lang;
          document.documentElement.dir = (lang === 'ar' ? 'rtl' : 'ltr');
        } catch (e) {}
      })();
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0E0B14">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self' https://streams.example.com; media-src https://streams.example.com blob:; font-src 'self' data:; frame-ancestors 'none'">
    <link rel="stylesheet" href="/styles.css">
</head>

  <body>
    <div id="root"></div>

    <!-- ✅ Vite سيضع هنا السكريبت بعد البناء -->
    <script type="module" src="/assets/index.js"></script>
    <!-- مكتبة HLS والمتغيرات الأساسية -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.18/dist/hls.min.js" defer></script>
    <script type="module" src="/js/i18n.js" defer></script>
    <script type="module" src="/js/player.js" defer></script>
    <script type="module" src="/js/nav.js" defer></script>
    <script>
      window.addEventListener('DOMContentLoaded', () => {
        window.I18N && window.I18N.apply();
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('/sw.js').catch(()=>{});
        }
      });
    </script>
</body>
</html>
